"use strict";var p=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var v=(o,e)=>{for(var t in e)p(o,t,{get:e[t],enumerable:!0})},x=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of T(e))!S.call(o,s)&&s!==t&&p(o,s,{get:()=>e[s],enumerable:!(i=A(e,s))||i.enumerable});return o};var w=o=>x(p({},"__esModule",{value:!0}),o);var b={};v(b,{AM:()=>h,AnimationManager:()=>a,astroAdapter:()=>m,barbaAdapter:()=>f,swupAdapter:()=>d});module.exports=w(b);var c=require("gsap"),l=require("gsap/ScrollTrigger");c.gsap.registerPlugin(l.ScrollTrigger);var a=class o{constructor(){this.adapter=null;this.activeAnimations=new Map;this.scrollTriggers=new Map;this.persistentAnimations=new Set;this.persistentScrollTriggers=new Set;this.contexts=new Map;this.isDebug=!1;this.logIcon="%c ";this.logIconStyle=['background: url("data:image/svg+xml,%3Csvg%20version%3D%221.0%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22400.000000pt%22%20height%3D%22400.000000pt%22%20viewBox%3D%220%200%20400.000000%20400.000000%22%20preserveAspectRatio%3D%22xMidYMid%20meet%22%3E%3Cg%20transform%3D%22translate(0.000000%2C400.000000)%20scale(0.100000%2C-0.100000)%22%20fill%3D%22%230ae448%22%20stroke%3D%22none%22%3E%3Cpath%20d%3D%22M853%203945%20c-202%20-36%20-385%20-133%20-533%20-284%20-189%20-194%20-281%20-430%20-274%20-708%205%20-262%2098%20-478%20283%20-664%20150%20-150%20310%20-234%20519%20-272%2063%20-11%2082%20-26%2037%20-28%20-14%20-1%20-28%20-2%20-32%20-3%20-5%20-1%20-26%20-5%20-48%20-10%20-287%20-57%20-567%20-291%20-685%20-573%20-55%20-132%20-73%20-224%20-74%20-378%200%20-283%2092%20-505%20289%20-700%20181%20-179%20399%20-273%20650%20-280%20446%20-12%20823%20248%20964%20667%2027%2081%2047%20178%2042%20206%20-1%206%202%2012%206%2012%205%200%2010%20-12%2011%20-27%207%20-91%2045%20-219%2095%20-318%20103%20-206%20297%20-387%20506%20-471%20213%20-86%20482%20-93%20694%20-18%20146%2053%20258%20124%20373%20239%20126%20126%20218%20293%20260%20473%2019%2078%2025%20259%2013%20352%20-42%20308%20-249%20594%20-534%20737%20-103%2052%20-306%20107%20-350%2094%20-5%20-1%20-6%201%20-2%205%204%204%2014%209%2022%2010%207%201%2032%205%2055%208%20310%2043%20615%20282%20738%20578%2058%20139%2075%20228%2076%20383%200%20154%20-14%20234%20-64%20364%20-87%20226%20-283%20432%20-504%20531%20-143%2064%20-269%2088%20-436%2084%20-298%20-7%20-550%20-134%20-745%20-375%20-92%20-113%20-171%20-295%20-191%20-439%20-3%20-23%20-7%20-48%20-8%20-55%20-1%20-8%20-6%20-18%20-10%20-22%20-4%20-4%20-6%20-3%20-5%202%207%2022%20-13%20129%20-37%20207%20-50%20158%20-124%20280%20-243%20399%20-138%20137%20-285%20218%20-481%20265%20-83%2020%20-284%2025%20-377%209z%20m1199%20-1279%20c93%20-264%20270%20-459%20521%20-576%2084%20-39%20228%20-80%20279%20-80%2043%200%2025%20-16%20-24%20-23%20-197%20-26%20-383%20-121%20-534%20-271%20-157%20-156%20-258%20-357%20-287%20-573%20-5%20-33%20-12%20-36%20-15%20-5%20-20%20257%20-196%20543%20-429%20698%20-115%2076%20-324%20153%20-423%20156%20-17%201%20-33%206%20-37%2011%20-3%206%20-2%207%204%204%2016%20-10%20203%2033%20283%2065%20307%20125%20554%20436%20596%20748%2010%2073%2017%2069%2031%20-15%208%20-44%2023%20-107%2035%20-139z%20m-1102%20-662%20c0%20-8%20-19%20-13%20-24%20-6%20-3%205%201%209%209%209%208%200%2015%20-2%2015%20-3z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E") no-repeat black center;',"background-repeat: no-repeat","background-position: center","background-size: 12px 12px","padding: 2px 6px","border-radius: 2px 0 0 2px"].join(";");this.logTitleStyle=["background: #424242","color: white","padding: 2px 4px","border-radius: 0 2px 2px 0"].join(";");this.logTitle="%cAnimationManager";this.logResetStyle=""}static getInstance(){return o.instance||(o.instance=new o),o.instance}init(e={}){let{debug:t=!1,adapter:i}=e;if(this.isDebug=t,i){if(this.adapter){this.log("\u26A0\uFE0F AnimationManager already has an adapter");return}this.adapter=i,this.setupAdapterHooks(),this.log(`\u2705 AnimationManager initialized with adapter: ${i.name}`)}else this.log("\u2705 AnimationManager initialized (standalone mode)")}destroy(){this.adapter?.destroy&&this.adapter.destroy(),this.adapter=null,this.forceCleanupAll(),this.log("\u{1F4A5} AnimationManager destroyed")}setupAdapterHooks(){this.adapter&&(this.adapter.onBeforeSwap(()=>{let e=Array.from(this.activeAnimations.keys()).some(s=>!this.persistentAnimations.has(s)),t=Array.from(this.scrollTriggers.keys()).some(s=>!this.persistentScrollTriggers.has(s)),i=Array.from(this.contexts.keys()).some(s=>!this.persistentAnimations.has(s));if(!e&&!t&&!i){this.isDebug&&this.log("\u26A1 No cleanup needed - only persistent animations active");return}this.isDebug&&this.log("\u{1F9F9} Cleaning up animations before page swap"),this.cleanupAll()}),this.adapter.onAfterSwap(()=>{this.log("\u{1F504} Page swapped, ready for new animations"),l.ScrollTrigger.refresh()}))}register(e,t,i){if(!this.activeAnimations.has(e)&&!this.contexts.has(e)){let s=Array.isArray(t)?t:[t];this.activeAnimations.set(e,s),i?.persist?(this.persistentAnimations.add(e),this.log(`\u2705 Registered PERSISTENT animation: ${e} (${s.length} tween/timeline)`)):this.log(`\u2705 Registered new animation: ${e} (${s.length} tween/timeline)`)}else this.log(`\u267B\uFE0F Reusing animation: ${e}`)}registerScrollTriggers(e,t,i){this.scrollTriggers.has(e)||(this.scrollTriggers.set(e,t),i?.persist?(this.persistentScrollTriggers.add(e),this.log(`\u{1F4CD} Registered PERSISTENT ScrollTriggers for: ${e}`)):this.log(`\u{1F4CD} Registered ScrollTriggers for: ${e}`))}animate(e,t,i){return this.register(e,t,i),Array.isArray(t)?t[0]:t}setup(e,t,i){if(!this.activeAnimations.has(e)&&!this.contexts.has(e)){let s=c.gsap.context(r=>{t(r)},i?.scope);this.contexts.set(e,s),this.activeAnimations.set(e,[{kill:()=>{}}]),i?.persist?(this.persistentAnimations.add(e),this.log(`\u{1F527} PERSISTENT setup completed: ${e}`)):this.log(`\u{1F527} Setup completed: ${e}`)}else this.log(`\u267B\uFE0F Setup already executed: ${e}`)}timeline(e,t,i){return this.animate(e,c.gsap.timeline(t),i)}scroll(e,t,i){if(this.scrollTriggers.has(e))return this.log(`\u26A0\uFE0F ScrollTrigger already exists for: ${e} - skipping`),null;let s=l.ScrollTrigger.create(t);return this.registerScrollTriggers(e,[s],i),s}killAnimations(e){if(!e||e.length===0)return;let t=e.filter(Boolean);t.length!==0&&t.forEach(i=>{try{i.kill()}catch(s){this.isDebug&&console.warn("Failed to kill animation:",s)}})}killScrollTriggers(e){!e||e.length===0||e.forEach(t=>t.kill())}cleanup(e,t=!1){if(!t&&this.isPersistent(e)){this.isDebug&&this.log(`\u{1F512} Skipping cleanup for persistent animation: ${e}`);return}let i=0,s=this.contexts.get(e);s&&(s.revert(),this.contexts.delete(e),i++);let r=this.activeAnimations.get(e);r&&(this.killAnimations(r),this.activeAnimations.delete(e),i++),this.cleanupScrollTriggers(e,t),t&&this.removePersistence(e),this.isDebug&&i>0&&this.log(`\u{1F9F9} Cleaned up: ${e}`)}cleanupScrollTriggers(e,t=!1){if(!t&&this.persistentScrollTriggers.has(e))return;let i=this.scrollTriggers.get(e);i&&(this.killScrollTriggers(i),this.scrollTriggers.delete(e),this.isDebug&&this.log(`\u{1F5D1}\uFE0F Cleaned ScrollTriggers: ${e} (${i.length})`))}cleanupAll(){this.isDebug&&this.trace("cleanupAll() called from:");let e={contexts:0,animations:0,scrollTriggers:0},t=[];for(let r of this.contexts.keys())this.persistentAnimations.has(r)||t.push(r);for(let r of t)this.contexts.get(r)?.revert(),this.contexts.delete(r),e.contexts++;let i=[];for(let r of this.activeAnimations.keys())this.persistentAnimations.has(r)||i.push(r);for(let r of i){let n=this.activeAnimations.get(r);n&&this.killAnimations(n),this.activeAnimations.delete(r),e.animations++}let s=[];for(let r of this.scrollTriggers.keys())this.persistentScrollTriggers.has(r)||s.push(r);for(let r of s){let n=this.scrollTriggers.get(r);n&&this.killScrollTriggers(n),this.scrollTriggers.delete(r),e.scrollTriggers++}if(this.persistentScrollTriggers.size>0){let r=new Set;for(let g of this.persistentScrollTriggers)this.scrollTriggers.get(g)?.forEach(u=>r.add(u));let n=[];for(let g of l.ScrollTrigger.getAll())r.has(g)||n.push(g);n.length&&this.killScrollTriggers(n)}else{let r=l.ScrollTrigger.getAll();r.length&&this.killScrollTriggers(r)}this.isDebug&&this.log(`\u{1F5D1}\uFE0F Cleanup completed: ${e.contexts} contexts, ${e.animations} animations, ${e.scrollTriggers} ScrollTriggers cleaned`)}forceCleanupAll(){this.contexts.forEach(t=>t.revert()),this.contexts.clear(),this.activeAnimations.forEach(t=>{this.killAnimations(t)}),this.activeAnimations.clear(),this.scrollTriggers.forEach(t=>{this.killScrollTriggers(t)}),this.scrollTriggers.clear(),this.persistentAnimations.clear(),this.persistentScrollTriggers.clear();let e=l.ScrollTrigger.getAll();e.length>0&&this.killScrollTriggers(e),this.log("\u{1F5D1}\uFE0F FORCE cleanup - everything destroyed")}removePersistence(e){this.persistentAnimations.delete(e),this.persistentScrollTriggers.delete(e),this.log(`\u{1F513} Removed persistence for: ${e}`)}isPersistent(e){return this.persistentAnimations.has(e)||this.persistentScrollTriggers.has(e)}refresh(e){if(!e){l.ScrollTrigger.refresh(!0),this.log("\u{1F504} All ScrollTriggers refreshed");return}let t=Array.isArray(e)?e:[e],i=0;t.forEach(s=>{let r=this.scrollTriggers.get(s);r?(r.forEach(n=>n.refresh()),i++,this.log(`\u{1F504} ScrollTriggers refreshed for: ${s}`)):this.log(`\u26A0\uFE0F No ScrollTriggers found for key: ${s}`)}),i>0&&this.log(`\u2705 Refreshed ScrollTriggers for ${i} key(s)`)}getStatus(){let e=Array.from(this.scrollTriggers.values()).reduce((i,s)=>i+s.length,0),t=this.persistentAnimations.size+this.persistentScrollTriggers.size;return{animations:this.activeAnimations.size,scrollTriggers:e,persistent:t,keys:[...this.activeAnimations.keys(),...this.scrollTriggers.keys(),...this.contexts.keys()],persistentKeys:[...this.persistentAnimations.keys(),...this.persistentScrollTriggers.keys()]}}isActive(e){return this.activeAnimations.has(e)||this.scrollTriggers.has(e)||this.contexts.has(e)}log(e,t){if(this.isDebug)if(Array.isArray(e)){let i=t||"Batch Operation";console.groupCollapsed(`${this.logIcon}${this.logTitle}%c ${i}`,this.logIconStyle,this.logTitleStyle,this.logResetStyle),e.forEach(s=>console.log(`${this.logIcon}${this.logTitle}%c ${s}`,this.logIconStyle,this.logTitleStyle,this.logResetStyle)),console.groupEnd()}else console.log(`${this.logIcon}${this.logTitle}%c ${e}`,this.logIconStyle,this.logTitleStyle,this.logResetStyle)}trace(e){this.isDebug&&console.trace(`${this.logIcon}${this.logTitle}%c ${e}`,this.logIconStyle,this.logTitleStyle,this.logResetStyle)}debug(){if(!this.isDebug)return;let e=this.getStatus();console.group(`${this.logIcon}${this.logTitle}%c Debug Info`,this.logIconStyle,this.logTitleStyle,this.logResetStyle),console.log("Active animations:",e.animations),console.log("Active ScrollTriggers:",e.scrollTriggers),console.log("Registered keys:",e.keys),console.log("Animations map:",this.activeAnimations),console.log("ScrollTriggers map:",this.scrollTriggers),console.groupEnd()}},h=a.getInstance();typeof window<"u"&&(window.AM=h);function d(o){let e=!1,t=r=>()=>{e||r()},i=null,s=null;return{name:"Swup",onBeforeSwap(r){i=t(r),o.hooks.before("content:replace",i)},onAfterSwap(r){s=t(r),o.hooks.on("content:replace",s)},destroy(){e=!0,i=null,s=null}}}function f(o){let e=!1;return{name:"Barba.js",onBeforeSwap(t){o.hooks.before("leave",()=>{e||t()})},onAfterSwap(t){o.hooks.after("enter",()=>{e||t()})},destroy(){e=!0}}}function m(o={}){let{refreshDelay:e=0}=o,t=null,i=null;return{name:"Astro View Transitions",onBeforeSwap(s){t=s,document.addEventListener("astro:before-swap",t)},onAfterSwap(s){i=()=>{e>0?setTimeout(s,e):s()},document.addEventListener("astro:after-swap",i)},destroy(){t&&(document.removeEventListener("astro:before-swap",t),t=null),i&&(document.removeEventListener("astro:after-swap",i),i=null)}}}0&&(module.exports={AM,AnimationManager,astroAdapter,barbaAdapter,swupAdapter});
//# sourceMappingURL=index.cjs.map